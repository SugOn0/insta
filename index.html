<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSTAEVENT</title>

    <style>
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
        }

        @font-face {
            font-family: 'SpoqaHanSansNeo-Regular';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2108@1.1/SpoqaHanSansNeo-Regular.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        html, body {
            width: 100%;
            height: 100%;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(-45.00deg, rgb(140, 86, 247),rgb(220, 143, 254) 100%);
        }

        main {
            width: 43.902vh;
            height: 85.121vh;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        video {
            width: 100%;
            border-radius: 0.609vh;
            background: black;
            transform: scaleX(-1);
        }
        
        .article {
            width: 100%;
            background-color: #ffffff;
            margin-top: 4.695vh;
            border-radius: 2.682vh;
        }

        .hb {
            width: 83%;
            height: 6.03vh;
            padding: 0;
            margin-left: 8.5%;
            margin-right: 8.5%;
            margin-top: 3vh;
            border-radius: 0.609vh;
            border: 0;
            color: #363535;
            text-align: center;
            font-size: 1.951vh;
            font-family: 'SpoqaHanSansNeo-Regular';
            background-color: #F2F2F2;
        }

        .hb:focus {
            border: 0;
            box-shadow: inset 0 0 0 1px #666666;
            outline: 0.1vh;
        }

        .hb-text {
            margin: 0;
            margin-left: 8.5%;
            color: #666666;
            font-size: 1.5vh;
        }

        .bu {
            width: 83%;
            height: 6.03vh;
            margin-left: 8.5%;
            margin-right: 8.5%;
            margin-top: 3vh;
            margin-bottom: 3vh;
            border-radius: 100vh;
            border: 0;
            font-size: 1.951vh;
            font-family: 'SpoqaHanSansNeo-Regular';
            color: white;
            background: linear-gradient(-45.00deg, rgb(220, 143, 254) 0%,rgb(140, 86, 247) 100%),rgb(141, 87, 247);
        }
        
        .bu:active {
            box-shadow: inset 0 0 0 2px #666666;
        }

        /* 여기에 추가 CSS 작성 */
    </style>
</head>
<body>
    <main>
        <video id="camera" autoplay playsinline></video>
        <article class="article">
            <input class="hb" placeholder="학번을 입력해주세요" maxlength="5">
            <input class="hb" placeholder="이름을 입력해주세요">
            <input class="hb" placeholder="인스타 아이디를 입력해주세요" oninput="this.value = this.value.toLowerCase()">
            <p class="hb-text">특수문자까지 완벽하게 작성해주세요</p>
            <button class="bu">이벤트 응모하기</button>
        </article>
        <img id="preview" style="width:100%; border-radius: 1vh; display: none; margin-top: 2vh;" />
    </main>

  <!-- JavaScript 작성 공간 -->
    <script>
        const video = document.getElementById('camera');
        const button = document.querySelector('.bu');
        const inputs = document.querySelectorAll('.hb');
        const preview = document.getElementById('preview');


        navigator.mediaDevices.getUserMedia({ video: true, audio: false })
            .then(stream => {
                video.srcObject = stream;
            })
            .catch(err => {
            console.error("카메라 접근 오류:", err);
            alert("카메라에 접근할 수 없습니다.");
        });
        
        // 버튼 클릭 시
        button.addEventListener('click', () => {
            const [studentId, name, instaId] = Array.from(inputs).map(input => input.value.trim());

            if (!studentId || !name || !instaId) {
                alert("모든 입력란을 채워주세요.");
                return;
            }

            // canvas로 카메라 이미지 캡처
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.translate(canvas.width, 0); // 좌우 반전
            ctx.scale(-1, 1);
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

            const imageData = canvas.toDataURL('image/png');

            // 미리보기 이미지 표시
            preview.src = imageData;
            preview.style.display = 'block';

            // 정보 확인 alert
            const confirmText = `다음 정보로 응모하시겠습니까?\n\n학번: ${studentId}\n이름: ${name}\n인스타 ID: ${instaId}`;
            if (confirm(confirmText)) {
                alert("응모가 완료되었습니다!");
                // 서버 전송 코드 추가 가능
            }
        });
    </script>
</body>
</html>
